# 텔레그램 봇 명령어 (Blog Scheduler)

서버에서 동작 중인 Blog Scheduler에 텔레그램으로 보낼 수 있는 명령어 정리.

---

## 1. 스케줄러 제어 (대기 중일 때)

스케줄러가 매일 09:00 대기 중일 때 아래 명령을 보내면 동작합니다.

| 명령 | 설명 |
|------|------|
| **시작**, **주제 선정**, **주제선정**, **시작해**, **오늘 주제** | 즉시 오늘 주제 선정을 시작하고, 이후 1차 승인 → 초안/소제목 → 사진 → 스케줄 → 발행 흐름으로 진행 |
| **상태**, **status**, **스케줄러 상태**, **스케줄러** | 현재 스케줄러 상태와 다음 실행 시각(또는 오늘 발행 예정 목록)을 보고 |
| **멈춤**, **일시정지**, **스케줄러 멈춤**, **정지** | 스케줄러 일시정지. 09:00이 되어도 자동 실행하지 않음. **재개** 또는 **시작** 입력 시 다시 동작 |
| **재개**, **스케줄러 재개**, **다시 시작** | 일시정지 해제. 다음 09:00 또는 **시작** 입력 시 정상 실행 |

---

## 2. 주제 보고 후 (1차 승인 대기)

주제가 텔레그램으로 보고된 뒤, 승인/거부/재선정을 할 때 사용합니다.

| 명령 | 설명 |
|------|------|
| **ok**, **승인**, **ㅇㅋ** | 전체 승인. 초안 생성 → 주제·소제목 보고 → 사진 취합 대기로 진행 |
| **취소**, **취소해**, **전체 취소**, **취소할게** | 오늘 발행 전체 취소. 스케줄러는 다시 대기 상태로 |
| **2,5 다시**, **재선정 2 5**, **1 3 다시**, **2 4**, **2,4** | 해당 번호(1~6)만 재선정. 같은 소스(시즌/네이버/구글 트렌드) 안에서만 다른 주제로 교체 |
| **전체 다시**, **다시**, **재선정** | 6편 전부 다시 선정 후 다시 보고 |
| **상태**, **status** | 현재 상태 안내: "승인 대기 중" |

---

## 3. 소제목 보고 후 (사진 취합 대기)

주제·소제목이 보고된 뒤, 소제목에 맞는 이미지를 보낼 때 사용합니다.

| 동작 / 명령 | 설명 |
|-------------|------|
| **사진 전송** | 캡션에 **1~6** 번호를 넣어 보내면 해당 번호 글에 이미지 배정. 번호 없으면 자동 배정 |
| **완료**, **사진 완료**, **완료해** | 사진 취합 완료. 발행 스케줄 생성 후 스케줄 보고 → 예정 시간에 발행 진행. 2시간 내 입력 없으면 자동으로 스케줄 진행 |

---

## 4. 흐름 요약

1. **09:00** 주제 선정 → 텔레그램 보고  
2. **1차 승인** (ok / 승인) 또는 취소·재선정  
3. 초안 생성 → **주제·소제목** 보고  
4. **사진 전송** (캡션에 1~6) → **완료** 입력 또는 2시간 타임아웃  
5. **발행 스케줄** 보고 → 예정 시간에 자동 발행  
6. **23시** 전후 포스팅 결과 보고 (성공/실패)

---

## 5. 상태 보고 예시

- **대기 중**: "상태: 대기 중 / 다음 실행: 2026-02-12 09:00 KST"  
- **승인 대기**: "상태: 1차 승인 대기 중"  
- **사진 대기**: "상태: 사진 취합 대기 중"  
- **발행 중**: "상태: 발행 진행 중" + 오늘 발행 예정 목록(시각, 작가, 키워드)  
- **일시정지**: "일시정지됨. 재개 또는 시작 입력 시 다시 실행됩니다."

---

## 6. 명령이 반응하지 않을 수 있는 구간 (블라인드 구간)

스케줄러가 **아래 구간**에 있을 때는 "상태", "시작" 같은 **명령을 읽지 않습니다**. 이때 보낸 메시지는 나중에 다음 대기 폴링(최대 약 15초 후)에서 처리됩니다.

| 구간 | 설명 |
|------|------|
| **초안 6편 생성 중** | 1차 승인 후 Gemini로 6편 초안을 만드는 동안. 수 분 소요될 수 있음. |
| **발행 실행 중** | 예정 시각에 1~6번 글을 순서대로 발행하는 동안. |

- **대기 중**이거나 **승인 대기**, **사진 취합 대기**일 때는 명령을 읽고 응답합니다.
- 명령을 보냈는데 응답이 없으면 15초~30초 후 다시 한 번 보내 보시거나, 서버 로그(`docker logs blog-scheduler`)에서 `[Telegram] getUpdates` / `command: status` 로그로 원인 확인이 가능합니다.
